---
layout: post
title:  "[코드스쿼드] 프론트엔드 Lv3 - STEP8 지연 처리"
subtitle:   "코드스쿼드"
categories: devlog
tags: HTMLCSS
comments: true
---

> 코드스쿼드 프론트엔드 Lv3 과정 중 [STEP 8] 지연처리를 구현하면서 발생한 이슈들에 대해서 기록한 글 입니다

## 목표

- 잔돈버튼은 별도로 구성하지 않음
- 상품이 선택되면 3초뒤에 자동으로 잔돈이 반환됨
- 3초안에 다른상품을 고르거나 추가금액이 투입되면 반환되지 않음

<br/>

<br/>

## 개발LOG

1. alert 대체

   맨 아래 footer 태그를 삽입 가운데 div를 놓고 가운데 정렬

   - 옆으로 나열되는 속성이 `inline` 임 (헷갈리지 말 것)
   - css 에서는 `visiblity: hidden;` 으로 적용 `visibility: 'hidden';` X
   - [visibility 속성](https://ofcourse.kr/css-course/visibility-%EC%86%8D%EC%84%B1)

   - div 가운데 정렬

     `margin: 0 auto;`

   - [div 안에서 텍스트 세로정렬](https://zetawiki.com/wiki/DIV_%EC%84%B8%EB%A1%9C_%EC%A4%91%EC%95%99_%EC%A0%95%EB%A0%AC)

     ```css
     .middle {
         display: flex;
         align-items: center;
         justify-content: center;
     }
     ```

   - 그 다음에 자바스크립트 단에서 객체 찾고

   - 해당 객체 innerText 바꿔주는 식으로 구현

   - 그 과정 중, show, hide 구현

     ```javascript
     setNodeVisibility(node, mode) {
         node.style.visibility = (mode === 'hidden') ? 'hidden' : 'visible'
     }
     ```

     노드 스타일의 visibility 속성을 `hidden` 아니면 `visible` 로 지정해주면 됨

   - alertMessage 함수를 개편하자

2. setTimeout 잔돈기능 구현

   - 상품이 선택되면 3초뒤에 자동으로 잔돈이 반환
   - setTimeout 함수를 전달받아 작동시키고 싶은데 작동을 안함 (나중에 연구가 필요해 보임)
   - 타이머 설계
     - 상품을 선택한 메서드에서 현재 1초간 타이머가 작동하고 있음 (상품 선택)
     - 타이머 안에 타이머를 넣어야 하나?
     - startProductSelectAfterHandler 메서드에 넣으면 될 것 같음
     - updateView 쪽에 Timer 를 하나 만들어 놓고
     - 뭐부터 해야하지
     - 잔돈 반환
       - 현재 투입된 금액 알아내기
       - 현재 투입된 금액 Model 에서 받아오기
       - 현재 투입된 금액 초기화 (0)
       - 현재 투입된 금액을 Model 로 접근해서 지갑에 더하기
       - refresh View
         - 투입된 금액
         - 현재 지갑
       - 로그찍기
     - 잔돈 반환 추가기능
       - 3초안에 다른 상품을 고르거나 추가금액이 투입되면 반환 X
         - 그러면 돈 투입 버튼에 메서드 하나 만들어서 넣고 (clearTimer)
         - 상품고를 때 메서드 하나 만들어서 넣으면 될듯 함
       - 반환될 금액이 존재하지 않으면 타이머 취소

3. exception class 생성

<br/>

<br/>

## 공사

```
현. view관련 클래스가 점점 늘어나고 있군요. 공사를 한번 하면 어떨까 제안합니다.
view가 여러가 나눈 단위가 '기능' 이거든요. 유틸, 업뎃,예외처리 등 이렇게 할 수 있다고 생각해요.
하지만 view가 많아지면 그때마다 (view마다) 이렇게 여러개의 기능이 나눠질거 같고요.
좀 혼란스러워질 수 있어요.
view를 동작중심으로 나누는 건 어때요?
지금은 응집도가 떨어져버리고 있어요.
물품리스트view, 지갑view 등 실제 화면을 바라보고(자판기를 바라보고) 동작의 경계점이 있는데 그걸 가지고 각각 view를 만들어보는거죠. 유틸,업뎃,에외처리는 각 뷰안에서 처리하고요.
그 뷰들간의 공통점이 있다면 그건 공통으로 뺄수는 있을텐데요. 이건 나중에 리팩토링 할 꺼리에요.
네 지금구현하거랑 앞으로 구현할거랑 스스로 차이도 느낄거고.
시간이 좀 걸려도 좋은 시도일거 같아요.
지금 코드에 리뷰는 약간 남겼는데, 참고하시고 전체 방향은 제가 제안한 것으로 현재 스텝을 다시 구현해보세요.
```

- 현재의 View를  `기능` 중심에서 `동작`중심으로 바꿔보자
  - 물품리스트 View
  - 지갑 View
  - 실제 화면(자판기)을 바라보고 동작의 경계점을 가지고 각각 View 를 만들어 볼 것
  - 유틸, 업뎃, 예외처리는 각 뷰안에서 처리
  - 각 뷰들 간 공통점이 있는것은 일단 나중에 리팩토링

